<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: java | Montree Bungnasang]]></title>
  <link href="http://gailo22.github.io/blog/categories/java/atom.xml" rel="self"/>
  <link href="http://gailo22.github.io/"/>
  <updated>2014-03-12T11:17:25+07:00</updated>
  <id>http://gailo22.github.io/</id>
  <author>
    <name><![CDATA[gailo22]]></name>
    <email><![CDATA[gailo22@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Create Integration Test with Spring]]></title>
    <link href="http://gailo22.github.io/blog/2014/03/05/create-integration-test-with-spring/"/>
    <updated>2014-03-05T11:20:55+07:00</updated>
    <id>http://gailo22.github.io/blog/2014/03/05/create-integration-test-with-spring</id>
    <content type="html"><![CDATA[<p>Assume you want to create a integration test for UserDao class which has CRUD methods e.g find, save, update, delete.</p>

<h3>Please note that for integration test:</h3>

<ul>
<li>we are testing with other system like db so, we may require populate example data before test.</li>
<li><p>the test method name should say that we are expecting the actual return value or save successfully, NOT invoke or interaction with some method</p></li>
<li><p>shouldReturnNewUserWhenCreateNewUserOnSave() –> <strong>OK</strong></p></li>
<li>shouldInvokeSaveMehtodWhenUserIsNotNullOnSave() –> <strong>NOT</strong></li>
</ul>


<p>```java
@Repository(&ldquo;userDao&rdquo;)
public class UserDaoImpl implements UserDao {</p>

<pre><code>User find(PK id) {...}
User save(User object) {...}
boolean delete(PK id) {...}
</code></pre>

<p>}
```</p>

<h2>Create new class name UserDaoIntegrationTest with annotations as below</h2>

<p>```java
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = &ldquo;classpath:applicationContext-dao-test.xml&rdquo;)
@Transactional
public class UserDaoIntegrationTest {</p>

<pre><code>...
</code></pre>

<p>}
```</p>

<h2>Inject class you want to test</h2>

<p><code>java
@Autowired
private UserDao userDao;
</code></p>

<h2>Crete test method</h2>

<p>```java
@Test
public void shoudXXX() {</p>

<pre><code>...  
</code></pre>

<p>}
```</p>

<h2>Verify actual return value</h2>

<p><code>java
assertThat(user.getUserName(), equalTo("user1"));
</code></p>

<h1>Method Template</h1>

<p>```java
@Test
public void should<Expecting>When<Criteria>On<MehtodName> {</p>

<pre><code>// Given
Populate require arguments for testing method.

// When
Invoke method you want to test with actual value.

// Then
Check return value from the method.
</code></pre>

<p>}
```</p>

<h1>Example</h1>

<p>```java
@Test
public void shouldReturnUserOnFindByKey() throws Exception {</p>

<pre><code>// Given // When 
final User user = this.userDao.find(1L);

// Then
assertThat(user.getUserName(), equalTo("user1"));
</code></pre>

<p>}</p>

<p>@Test
public void shouldCreateNewUserOnSave() throws Exception {</p>

<pre><code>// Given 
final User newUser = User.getDefaultObject();
newUser.setReferenceType(ReferenceType.MYKAD);
newUser.setUserName("abc");
newUser.setPassword("password");
newUser.setName("name");
newUser.setEmail("abc@email.com");
newUser.setUserStatus(UserStatus.ACTIVE);
newUser.setCreatedBy("admin");
newUser.setLastModifiedBy("admin");

// When
final User createdUser = this.userDao.save(newUser);

// Then
final User foundUser = this.userDao.find(createdUser.getId());
assertThat(foundUser.getUserName(), equalTo("abc"));
assertThat(foundUser.getPassword(), equalTo("password"));
assertThat(foundUser.getEmail(), equalTo("abc@email.com"));
assertThat(foundUser.getCreatedBy(), equalTo("admin"));
assertThat(foundUser.getLastModifiedBy(), equalTo("admin"));
</code></pre>

<p>}
```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Create Unit Test with Mockito]]></title>
    <link href="http://gailo22.github.io/blog/2014/03/03/create-unit-test-with-mockito/"/>
    <updated>2014-03-03T15:21:30+07:00</updated>
    <id>http://gailo22.github.io/blog/2014/03/03/create-unit-test-with-mockito</id>
    <content type="html"><![CDATA[<p>Assume you want to create a unit test for UserService class, getUserByUserName(String username) method.</p>

<p>```java
@Service(&ldquo;userService&rdquo;)
public class UserServiceImpl implements UserService {</p>

<pre><code>@Autowired
private UserDao userDao;

public User getUserByUserName(String username) {
    ...
    userDao.getUserByName(username);
    ...
}
</code></pre>

<p>}
```</p>

<h2>Create new class name UserServiceImplTest</h2>

<p>```java
public class UserServiceImplTest {</p>

<pre><code>...
</code></pre>

<p>}
```</p>

<h2>Inject class you want to test</h2>

<p>```java
@InjectMocks
private UserServiceImpl userService;</p>

<p>```</p>

<h2>Mock related objects</h2>

<p><code>java
@Mock
private UserDao userDaoMock;
</code></p>

<h2>Setup annotation support</h2>

<p>```java
@Before
public void setup() {</p>

<pre><code>initMocks(this);
</code></pre>

<p>}
```</p>

<h2>Create test method</h2>

<p>```java
@Test
public void shoudXXX() {</p>

<p>}
```</p>

<h2>Verify expectation</h2>

<p><code>java
verify(userService).getUserById("admin");
assertThat(true, equalTo(true));
</code></p>

<h2>Static import required classes</h2>

<p>```java
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;</p>

<p>import static org.hamcrest.core.IsEqual.equalTo;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;
import static org.mockito.MockitoAnnotations.initMocks;
```</p>

<h1>Method Template</h1>

<p>```java
@Test
public void should<Expecting>When<Criteria>On<MehtodName> {</p>

<pre><code>// Given
Declare your mock object and expectation.

// When
Invoke method you want to test.

// Then
Verify method invocation.
Check return value from the method.
</code></pre>

<p>}
```</p>

<h1>Example</h1>

<p>```java
@Test
public void shouldReturnUserWhenUserNameIsNotNullOnGetUserByUserName {</p>

<pre><code>// Given
User userMock = mock(User.class);
when(userDaoMock.getByUserName("admin")).thenReturn(userMock);

// When
User returnUser = userService.getUserByUserName("admin");

// Then
assertThat(returnUser, equalTo(userMock));
</code></pre>

<p>}
```</p>
]]></content>
  </entry>
  
</feed>
